---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

export async function getStaticPaths() {
  const blogEntries = await getCollection("blog");

  return blogEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const tags: string[] = entry.data.tags?.split(",") ?? [];
---

<Layout
  title={entry.data.title}
  description={entry.data.description}
  image={entry.data.image}
>
  <h1>{entry.data.title}</h1>
  <small>Posted on: {entry.data.date}</small>

  <div class="tags">
    {tags.map((tag) => <span class="tag">#{tag}</span>)}
  </div>
  <hr />

  <article class="blog-content">
    <Content />
  </article>

  <br />

  <small id="disclaimer">
    A small disclaimer: if you are reading this, and want to comment on
    anything, you'd have to reach out directly. this platform is still in its
    infancy and im yet to add all the "social" features; I also highly doubt my
    content would be engaging enough anyway to spark engagement but you never
    know when people want to discuss something, or, .... hate lol
  </small>
</Layout>

<script>
  import mediumZoom from "medium-zoom";

  const images = document.querySelectorAll(".blog-content img");
  if (images.length > 0) {
    mediumZoom(images, {
      margin: 48,
      scrollOffset: 0,
      background: "rgba(0, 0, 0, 0.78)",
    });
  }
</script>

<style>
  #disclaimer {
    color: #3b3b3b;
  }
  .tags {
    margin: 0.75rem 0 1rem;
  }

  .tag {
    display: inline-block;
    margin: 0.25rem 0.4rem 0.25rem 0;
    padding: 0.25rem 0.6rem;
    font-size: 0.7rem;
    border-radius: 999px;
    background: #f1f3f5;
    color: #333;
  }
</style>
